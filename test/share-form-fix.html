<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Share Form Fix - SecureShare</title>
    <link rel="stylesheet" href="../popup/css/styles.css">
    <style>
        body {
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .test-container {
            width: 28rem;
            max-height: 45rem;
            min-height: 32rem;
        }
    </style>
</head>
<body class="body">
    <div class="app test-container">
        <!-- Share Form Section -->
        <section class="share">
            <div class="back-button-top">
                <div class="js-go-back-top go-back-top link">&lsaquo;</div>
            </div>
            <div class="title">Current Account</div>
            <div class="explanation">You're about to share your <i>"AI Augmentation Development Guidelines - Claude"</i> session.</div>

            <form action="/" id="js-share-session">
                <div class="small">Recipient code <span class="link" data-balloon="Paste the code of the person you want to share your extension with." data-balloon-length="medium" data-balloon-pos="right">?</span></div>

                <div class="input-container">
                    <input type="text" name="pubkey" placeholder="Code of the computer you're sharing with" autocomplete="off" required />
                </div>

                <div class="small">Timeout in hours <span class="link" data-balloon="Explanation about timeout duration." data-balloon-length="medium" data-balloon-pos="right">?</span></div>

                <div class="input-container timeout-container">
                    <input type="number" name="timeout" min="1" placeholder="It'll last a week by default." autocomplete="off" />
                    <div id="js-expires-on" class="expires-on">Expires: Tomorrow 2:30 PM</div>
                </div>

                <div class="flex-container">
                    <div class="go-back">‹ back</div>
                    <input type="submit" name="submit" class="btn" value="Share" />
                </div>
            </form>

            <!-- Share Result Section -->
            <div id="js-shared-session" class="shared-session" style="margin-top: 2rem;">
                <div class="small">Share result <span class="link" data-balloon="Share this text with the owner of the code" data-balloon-length="medium" data-balloon-pos="right">?</span> <span class="link delete">×</span></div>

                <pre class="encrypted-data share-result">eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiYWRtaW4iOnRydWV9.EkN-DOsnsuRjRO6BxXemmJDm3HbxrbRzXglbN2S4sOkopdU4IsDxTI8jO19W_A4K8ZPJijNLis4EZsHeY559a4DFOd50_OqgHs3UjlKOCuOuFiF6_CnImOlK4g6k2-WgjMGlzYNnaAjNu2U9aSEiMYBqGRTLPbYLdaHHVfgUDjI</pre>

                <div class="action-icon" data-clipboard data-clipboard-target=".share-result" data-balloon="Copy encryption" data-balloon-pos="right">
                    <img src="../popup/images/copy.svg" alt="Copy encryption" width="12" />
                </div>
            </div>
        </section>
    </div>
    
    <script>
        // Add some interactivity
        document.querySelectorAll('.btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                btn.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    btn.style.transform = '';
                }, 150);
            });
        });
        
        // Add focus effects
        document.querySelectorAll('input').forEach(input => {
            input.addEventListener('focus', () => {
                console.log('Input focused:', input.placeholder);
            });
            
            input.addEventListener('input', (e) => {
                console.log('Input value:', e.target.value);
            });
        });
        
        // Enhanced functionality for testing
        document.addEventListener('DOMContentLoaded', () => {
            const recipientInput = document.querySelector('input[name="pubkey"]');
            const timeoutInput = document.querySelector('input[name="timeout"]');
            const expiresOn = document.getElementById('js-expires-on');
            const submitBtn = document.querySelector('input[type="submit"]');

            // Function to update expires date
            function updateExpiresDate() {
                const hours = parseInt(timeoutInput.value) || 168; // Default 1 week
                const expiryDate = new Date();
                expiryDate.setHours(expiryDate.getHours() + hours);

                const options = {
                    weekday: 'short',
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                };

                expiresOn.textContent = `Expires: ${expiryDate.toLocaleDateString('en-US', options)}`;
                expiresOn.classList.add('visible');
            }

            // Function to check form validity
            function checkFormValidity() {
                const isValid = recipientInput.value.trim().length > 0;
                submitBtn.disabled = !isValid;
            }

            // Event listeners
            timeoutInput.addEventListener('input', updateExpiresDate);
            recipientInput.addEventListener('input', checkFormValidity);

            // Form submission
            document.getElementById('js-share-session').addEventListener('submit', (e) => {
                e.preventDefault();
                alert('Share form submitted! (This is just a demo)');
            });

            // Add some sample data after a delay
            setTimeout(() => {
                if (recipientInput) {
                    recipientInput.value = 'ABC123XYZ789';
                    checkFormValidity();
                }
                if (timeoutInput) {
                    timeoutInput.value = '24';
                    updateExpiresDate();
                }
            }, 1500);
        });
    </script>
</body>
</html>
